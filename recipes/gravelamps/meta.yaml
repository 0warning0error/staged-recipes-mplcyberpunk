{% set name = "gravelamps" %}
{% set version = "2.3.1rc14" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://git.ligo.org/mick.wright/Gravelamps/-/archive/{{ version }}/Gravelamps-{{ version }}.tar.gz
  sha256:  95569b7a1bf3b44574b3915da1bd7404434d8c3823b8d7e62849eab8d4950bf5

build:
  entry_points:
    - gravelamps_inference=gravelamps.inference:main
    - gravelamps_generate_lens=gravelamps.generate_lens:main
    - gravelamps_generate_interpolator_data=gravelamps.lensing.generic:main
  script: {{ PYTHON }} -m pip install . -vv
  number: 0
  skip: true  # [not linux or py<=39]

requirements:
  build:
    - {{ compiler('cxx') }}
    - make
    - sysroot_linux-64
  host:
    - python
    - setuptools-scm
    - pip
    - make
    - arb
    - libflint
    - libgomp
    - boost-cpp
  run:
    - python
    - asimov
    - astropy
    - bilby
    - bilby_pipe
    - python-htcondor
    - numpy
    - scipy

test:
  imports:
    - gravelamps
    - gravelamps.lensing.point
  commands:
    - pip check
    - gravelamps_inference --help
    - gravelamps_generate_lens --help
    - gravelamps_generate_interpolator_data --help
  requires:
    - pip
    - sysroot_linux-64
    - libstdcxx-ng
    - arb
    - libflint

about:
  home: https://git.ligo.org/mick.wright/Gravelamps
  summary: Software package designed for running template based analysis of lensed gravitational wave signals to determine the lens profile model. Built on top of the parameter estimation framework, Bilby, and arbitrary precision library arb
  license: MIT
  license_file: LICENSE

extra:
  recipe-maintainers:
    - mick-wright
